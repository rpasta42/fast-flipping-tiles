<html>
<head>
   <title>Welcome to BusinessCape/FamilyCape</title>
   <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js'></script>

   <script>
      $(function() {
         $('#left-tile').click(function() {
            window.location = 'http://businesscape.com/';
         });
         $('#right-tile').click(function() {
            window.location = 'https://familycape.com/';
         });

         var cName = 'unhovered-tile';
         $('.my-tile').hover(function() {
            if ($(this).attr('id') == 'left-tile')
               $('#right-tile').addClass(cName);
            else $('#left-tile').addClass(cName);

         }, function() {
            $('.my-tile').removeClass(cName);
         });

         /*function fixTileBack() {
            $('.my-tile').each(function() }
               var width = $(this).find('.tile-front').width();
               $(this).find('.tile-back').width(width);
            });
         }
         setTimeout(fixTileBack, 0);
         setTimeout(fixTileBack, 100);*/

      });
   </script>

   <style>
      body {
         color:   #8495a1;
      }
      #left-tile {
         position:      absolute;
         background-color:    /*#5bc0de;*/ #fafafa;
         border-top-right-radius:    0;
         border-bottom-right-radius:    0;
      }
      #right-tile {
         background-color: #fafafa;    /*#f1c954; #0e9d57;*/
         position:      absolute;
         left:          50%;
         border-top-left-radius:    0;
         border-bottom-left-radius:    0;
      }
      .my-tile {
         width:         50%;
         height:        90%;
         border-radius: 10px;
         text-align:    center;
         overflow:      hidden;
         /*opacity:       0.9;
         filter:        blur(3px);*/
      }
      .unhovered-tile-kk {
         opacity:       0.9;
         filter:        blur(3px);
      }
      .my-tile:hover {
         /*opacity: 1;
         filter:  none;*/
         cursor:  pointer;
      }
      body {
         /*padding:       0;
         margin:        0;*/
         margin:        40px;
         /*background-color:    #f1c954;*/
         background-color:    #eeeeee;
      }
      #tile-container {
         position:      relative;
         width:         100%;
         height:        100%;
      }
      .tile-img {
         width:         100%;
         height:        100%;
      }
      #left-img-bottom {
         height:        20px;
      }
      #right-img-top, #left-img-top, #left-back-logo, #right-back-logo {
         /*width:         558px;
         height:        200px;*/
         max-height:    200px;
         max-width:     558px;
         width:         90%;
         margin:        8px;
         padding:       8px;
      }
      #left-img-bottom, #right-img-bottom {
         height:        100%;
      }
      .desc {
         width:         350px;
         position:      absolute;
         left:          50%;
         transform:     translateX(-50%);
         font-size:     150%;
      }

      .my-tile {
         border-style:  solid;
         border-width:  1px;
         border-color:  #8495a1;
      }
   </style>

   <style>
         /*opacity:       0.9;
         filter:        blur(3px);*/

      @keyframes rotate-y-forward-90 {
         from {transform: rotateY(0deg); opacity: 1; filter: blur(0px);}
         to   {transform: rotateY(90deg); opacity: 0.1; filter: blur(3px);}
      }
      @keyframes rotate-y-backwards-90 {
         from {transform: rotateY(90deg); opacity: 0.0; filter: blur(3px); }
         to   {transform: rotateY(0deg); opacity: 1; filter: blur(0px); }
      }


      @keyframes fade-out {
         from {opacity:1; filter: blur(0px);}
         to   {opacity:0.6; filter: blur(3px);}
      }
      @keyframes fade-in {
         from {opacity:0.6; filter:blur(3px); }
         to   {opacity:1; filter:blur(0px); }
      }

   </style>

   <script>
      var checkIfOutTime = 150;//400;
      var tileRotTime = 0.2; //default:0.2; kinda slow: 0.5 //!!!USE 5.0 seconds for demo of fades
      var fadeTime = 0.5;
      var tileRotTimeMilli = tileRotTime * 1000;

      function animate(el, animationName, duration) {
         el.css('animation-name', animationName);
         el.css('animation-duration', duration + 's');
         el.css('animation-fill-mode', 'forwards');
      }

      $(function() {
         $('.my-tile').find('.tile-front').show();
         $('.my-tile').find('.tile-back').hide();

         /* old
         inactive = default
         rotating90 = started rotation
         rotating180 = finsihed half rotation
         flipped_start = just finished flipping, need to wait before rotating back
         flipped_ready = waited minimum amount, ready to rotate back
         reversing = rotating back
         inactive/finished = either use separate state, or just revert to inactive
         status of rotation
         (inactive, rotating90, rotating180, flipped_start, flipped-ready, reversing, inactive/finished)*/

         //new statuses = [inactive, started-forward, started-reverse, flipped-ready]
         var tileState = { 'left-tile':'inactive', 'right-tile':'inactive' };

         /*function periodic() {
            console.log('left hover: ' + $('#left-tile:hover').length);
            console.log('right hover: ' + $('#right-tile:hover').length);
            setTimeout(periodic, 1000);
         }
         periodic();*/

         //t = hovered object, tId = 'left-tile' or 'right-tile'
         function onMoveIn(t, tId, front, back) {
            for (var tileId in tileState) {
               if (tileState[tileId] != 'inactive') {
                  //return;
                  //setTimeout(function () { onMoveIn(t, tId, front, back); }, checkIfOutTime);
                  function check() {
                     if ($('#' + tId + ':hover').length != 0)
                        onMoveIn(t, tId, front, back);
                  }
                  /*for (var i = 1; i < 2; i++) {
                     setTimeout(check, checkIfOutTime*i);
                  }*/
                  setTimeout(check, checkIfOutTime*2);
                  return;
               }
            }
            /*if (tileState[tId] != 'inactive')
               return;*/

            animate(front, 'rotate-y-forward-90', tileRotTime);

            if (tId == 'left-tile') {
               animate($('#right-tile'), 'fade-out', fadeTime);
            } else {
               animate($('#left-tile'), 'fade-out', fadeTime);
            }

            tileState[tId] = 'started-forward';

            setTimeout(function() {
               front.hide();
               back.show();
               animate(back, 'rotate-y-backwards-90', tileRotTime);
               setTimeout(function() {
                  tileState[tId] = 'flipped-ready';
                  function checkIfOut() {
                     //if (!t.is(':hover'))
                     if ($('#' + tId + ':hover').length == 0)
                        onMoveOut(t, tId, front, back);
                     else
                        setTimeout(checkIfOut, checkIfOutTime);
                  }
                  checkIfOut();
               }, tileRotTimeMilli);
            }, tileRotTimeMilli);
         }

         function onMoveOut(t, tId, front, back) {
            if (tileState[tId] != 'flipped-ready') {
               /*setTimeout(function () { onMoveOut(t, tId, front, back); }, 400);
               return;*/
            }
            tileState[tId] = 'started-reverse';
            animate(back, 'rotate-y-forward-90', tileRotTime);

            if (tId == 'left-tile') {
               animate($('#right-tile'), 'fade-in', fadeTime);
            } else {
               animate($('#left-tile'), 'fade-in', fadeTime);
            }

            setTimeout(function() {
               back.hide();
               front.show();
               animate(front, 'rotate-y-backwards-90', tileRotTime);
               setTimeout(function() { tileState[tId] = 'inactive'; }, tileRotTimeMilli);

            }, tileRotTimeMilli);
         }

         function onTileHover(obj, isHoverIn) {
            var objId = $(obj).attr('id');
            var back = $(obj).find('.tile-back');
            var front = $(obj).find('.tile-front');
            if (isHoverIn)
               onMoveIn(obj, objId, front, back);
            /*else
               onMoveOut(obj, objId, front, back);*/
         }

         $('.my-tile').hover(function() {
            onTileHover($(this), true);
         }, function() {
            onTileHover($(this), false);
         });
      });
   </script>
</head>
<body>

   <center style='color:#8495a1'>Select website to continue</center></br>

   <div id='tile-container'>
      <div id='left-tile' class='my-tile'>
         <!-- <img class='tile-img' id='left-img' src='../assets/businesscape1.png'> -->
         <div class='tile-front'>
            <img class='tile-img' id='left-img-top' src='../assets/familycape/split-select/logo-businesscape.png'>
            <img class='tile-img' id='left-img-bottom' src='../assets/familycape/split-select/bus_scrot.png'>
         </div>
         <div class='tile-back'>
            <img class='tile-img' id='left-back-logo' src='../assets/familycape/split-select/logo-businesscape.png'></br></br>
            <div class='desc'>
            At BusinessCape, we work with various-sized businesses to analyze costs and and optimize profits.
            </div>
         </div>
      </div>

      <div id='right-tile' class='my-tile'>
         <div class='tile-front'>
            <!-- <img class='tile-img' id='right-img' src='../assets/familydebt1.png'> -->
            <img class='tile-img' id='right-img-top' src='../assets/familycape/logo.png'>
            <img class='tile-img' id='right-img-bottom' src='../assets/familycape/split-select/fam_scrot.png'>
         </div>
         <div class='tile-back'>
            <img class='tile-img' id='right-back-logo' src='../assets/familycape/logo.png'></br></br>
            <div class='desc'>
               At FamilyCape, we specialize in working with families to minimize their debt, and pay it off as quickly as possible.
            </div>
         </div>
      </div>
   </div>
</body>
</html>

